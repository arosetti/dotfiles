#!/bin/sh
. $ENV_HOME/scripts/functions.sh
run_as_root $@

VERSION="0.1.1"

echo -e "Spymerge $VERSION roarc (alessandro.rosetti@gmail.com)\n"

ELOG="/var/tmp/"
LAST=$(find $ELOG -mmin -1 -type f -name "build.log" -print 2>/dev/null)
LAST=$(echo $LAST | sort)

sel() {
  h=1
  for item in $LAST; do
    if [ "$h" -eq $1 ]; then
      SELECTED=$item
    fi
    ((h++))
  done
}

i=1
for item in $LAST; do
  echo "$i) $item"
  ((i++))
done

[ $i = 0 ] && exit 0

sel 1
if [ $i -gt 2 ]; then
  read -p "Select [1:$((i - 1))] ? "
  sel $REPLY
fi

tail -f $SELECTED
