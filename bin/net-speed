#!/bin/sh

if [ -z "$1" ]; then
  echo usage: $0 network-interface
  echo
  echo e.g. $0 eth0
  echo
  exit
fi

show_speed() {
  IF=$1
  SEC=1
  ((CONV = 1024 * $SEC))

  R1=$(cat /sys/class/net/$1/statistics/rx_bytes)
  T1=$(cat /sys/class/net/$1/statistics/tx_bytes)
  sleep $SEC
  R2=$(cat /sys/class/net/$1/statistics/rx_bytes)
  T2=$(cat /sys/class/net/$1/statistics/tx_bytes)
  ((TBPS = $T2 - $T1))
  ((RBPS = $R2 - $R1))
  ((TKBPS = $TBPS / $CONV))
  ((RKBPS = $RBPS / $CONV))
  echo "$1: tx $TKBPS kB/s rx $RKBPS kB/s"
}

while :; do
  show_speed $1
done
